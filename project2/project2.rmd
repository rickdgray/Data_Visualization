---
title: "Project 2"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
```

This is the dataset you will be working with:
```{r message = FALSE}
olympics <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-07-27/olympics.csv')

olympic_gymnasts <- olympics %>% 
  filter(!is.na(age)) %>%             # only keep athletes with known age
  filter(sport == "Gymnastics") %>%   # keep only gymnasts
  mutate(
    medalist = case_when(             # add column for success in medaling
      is.na(medal) ~ FALSE,           # NA values go to FALSE
      !is.na(medal) ~ TRUE            # non-NA values (Gold, Silver, Bronze) go to TRUE
    )
  )

```

More information about the dataset can be found at https://github.com/rfordatascience/tidytuesday/tree/master/data/2021/2021-07-27/readme.md and https://www.sports-reference.com/olympics.html.

**Question:** Are there age differences for male and female Olympic gymnasts who were successful or not in earning a medal, and how has the age distribution changed over the years? 

We recommend you use a violin plot for the first part of the question and faceted boxplots for the second question part of the question. 

**Hints:**

- To make a series of boxplots over time, you will have add the following to your `aes()` statement: `group = year`. 
- It can be a bit tricky to re-label facets generated with `facet_wrap()`. The trick is to add a `labeller` argument, for example:
```r
 + facet_wrap(
    # your other arguments to facet_wrap() go here
    ...,
    # this replaces "TRUE" with "medaled" and "FALSE" with "did not medal"
    labeller = as_labeller(c(`TRUE` = "medaled", `FALSE` = "did not medal"))
  )
```

**Introduction:** *Your introduction here.*

**Approach:** *Your approach here.*

**Analysis:**

```{r }

ggplot(olympic_gymnasts, aes(sex, age, fill = medalist)) +
  geom_violin()

```

```{r fig.width=10 }

ggplot(olympic_gymnasts, aes(year, age, fill = sex, group = interaction(year, sex))) +
  geom_boxplot() +
  facet_wrap(
    vars(medalist),
    labeller = as_labeller(c('TRUE' = "medaled", 'FALSE' = "did not medal"))
  )

```

By the first plot, the median difference is 1 year.

